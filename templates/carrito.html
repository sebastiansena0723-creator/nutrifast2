{% extends 'base.html' %}

{% block content %}
<section class="cart-section">
    <div class="container">
        <h2 class="section-title">Tu Carrito de Compras</h2>
        
        {% if carrito %}
        <div class="cart-items">
            {% for item in carrito %}
            <div class="cart-item">
                
                <div class="cart-item-image">
                    <img src="{{ url_for('static', filename='img/' + item.imagen) }}"
                         alt="{{ item.nombre }}"
                         onerror="handleImageError(this)">
                </div>
                
                <div class="item-details">
                    <h3 class="item-name">{{ item.nombre }}</h3>
                    <p class="item-descripcion">{{ item.descripcion }}</p>
                </div>
                
                <div class="item-controls">
                    <form action="{{ url_for('actualizar_carrito') }}" method="POST" class="quantity-form">
                        <input type="hidden" name="id" value="{{ item.id }}">
                        <button type="submit" name="accion" value="decrementar" class="qty-btn">-</button>
                        <span class="quantity">{{ item.cantidad }}</span>
                        <button type="submit" name="accion" value="incrementar" class="qty-btn">+</button>
                    </form>
                </div>
                
                <div class="item-price-and-actions">
                    <div class="item-price">
                        ${{ "{:,}".format(item.precio * item.cantidad) }}
                    </div>
                    
                    <form action="{{ url_for('actualizar_carrito') }}" method="POST" class="remove-form">
                        <input type="hidden" name="id" value="{{ item.id }}">
                        <button type="submit" name="accion" value="eliminar" class="remove-btn">üóëÔ∏è Quitar</button>
                    </form>
                </div>
                
            </div>
            {% endfor %}
        </div>
        
        <div class="cart-summary">
            <div class="summary-row">
                <span class="summary-label">Subtotal:</span>
                <span class="summary-value">${{ "{:,}".format(total) }}</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Env√≠o:</span>
                <span class="summary-value">$3,000</span>
            </div>
            <div class="summary-row total-row">
                <span class="summary-label">Total:</span>
                <span class="summary-value">${{ "{:,}".format(total + 3000) }}</span>
            </div>
            
            <div class="cart-actions">
                <a href="{{ url_for('vaciar_carrito') }}" class="btn btn-secondary">Vaciar Carrito</a>
                <button onclick="procesarPago()" class="btn btn-primary">Procesar Pedido</button>
            </div>
        </div>
        
        {% else %}
        <div class="empty-cart">
            <p class="empty-cart-message">üõí Tu carrito est√° vac√≠o</p>
            <a href="{{ url_for('menu') }}" class="btn btn-primary">Ver Men√∫</a>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}