{% extends "base.html" %}

{% block content %}
<section class="cart-section">
    <div class="container">
        <h2 class="section-title">Tu Carrito de Compras</h2>

        {# Check if the cart has items #}
        {% if carrito %}
        <div class="cart-items">
            {# Iterate over each item in the cart #}
            {% for item in carrito %}
            <div class="cart-item">
                
                {# Item Image: Added closing slash (/) to the <img> tag for HTML5 compliance #}
                <div class="cart-item-image">
                    <img src="{{ url_for('static', filename='img/' + item.imagen) }}"
                         alt="{{ item.nombre }}"
                         
                </div>
                
                {# Item Details #}
                <div class="item-details">
                    <h3 class="item-name">{{ item.nombre }}</h3>
                    <p class="item-descripcion">{{ item.descripcion }}</p>
                </div>

                {# Item Controls (Quantity update) #}
                <div class="item-controls">
                    
                    {# üí° CRITICAL FIX: Added the missing closing </form> tag #}
                    <form action="{{ url_for('actualizar_carrito') }}" method="POST" class="quantity-form">
                        <input type="hidden" name="id" value="{{ item.id }}">
                        
                        {# Decrement button #}
                        <button type="submit" name="accion" value="decrementar" class="qty-btn">-</button>
                        
                        {# Quantity display #}
                        <span class="quantity">{{ item.cantidad }}</span>
                        
                        {# Increment button #}
                        <button type="submit" name="accion" value="incrementar" class="qty-btn">+</button>
                    </form>
                    {# ‚¨ÜÔ∏è FIX APPLIED: The form is now properly closed #}
                </div>
                
                {# Item Price and Remove Button #}
                <div class="item-price-and-actions">
                    <div class="item-price">
                        ${{ '%.2f'|format(item.precio * item.cantidad) }}
                    </div>
                    
                    {# Remove Form #}
                    <form action="{{ url_for('actualizar_carrito') }}" method="POST" class="remove-form">
                        <input type="hidden" name="id" value="{{ item.id }}">
                        {# Added 'Quitar' text to the button for the user #}
                        <button type="submit" name="accion" value="eliminar" class="remove-btn">Quitar</button>
                    </form>
                </div>
                
            </div>
            {% endfor %}
        </div>
        {% else %}
        {# Case for an empty cart #}
        <p class="empty-cart-message">Tu carrito de compras est√° vac√≠o.</p>
        {% endif %}

    </div>
</section>
{% endblock content %}